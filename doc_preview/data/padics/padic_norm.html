<html><head><link rel="stylesheet" href="../../docs_style.css"></head><h1>p-adic norm</h1>
<p>This file defines the p-adic valuation and the p-adic norm on ℚ.</p>
<p>The p-adic valuation on ℚ is the difference of the multiplicities of <span style="background-color:#fdf6e3;color:#657b83;">p</span> in the numerator and
denominator of <span style="background-color:#fdf6e3;color:#657b83;">q</span>. This function obeys the standard properties of a valuation, with the appropriate
assumptions on p.</p>
<p>The valuation induces a norm on ℚ. This norm is a nonarchimedean absolute value.
It takes values in {0} ∪ {1/p^k | k ∈ ℤ}.</p>
<h2>Notations</h2>
<p>This file uses the local notation <span style="background-color:#fdf6e3;color:#b58900;">/</span><span style="background-color:#fdf6e3;color:#657b83;">.</span> for <span style="background-color:#fdf6e3;color:#657b83;">rat.mk</span>.</p>
<h2>Implementation notes</h2>
<p>Much, but not all, of this file assumes that <span style="background-color:#fdf6e3;color:#657b83;">p</span> is prime. This assumption is inferred automatically
by taking (prime p) as a type class argument.</p>
<h2>References</h2>
<ul>
<li>[F. Q. Gouêva, <em>p-adic numbers</em>][gouvea1997]</li>
<li>[R. Y. Lewis, <em>A formal proof of Hensel's lemma over the p-adic integers</em>][lewis2019]</li>
<li>https://en.wikipedia.org/wiki/P-adic_number</li>
</ul>
<h2>Tags</h2>
<p>p-adic, p adic, padic, norm, valuation</p>
<hr/><div class="decl"><h4>padic_val_rat</h4><div class="decl_par"><p>For <span style="background-color:#fdf6e3;color:#657b83;">p </span><span style="background-color:#fdf6e3;color:#b58900;">≠ </span><span style="background-color:#fdf6e3;color:#6c71c4;">1</span>, the p-adic valuation of an integer <span style="background-color:#fdf6e3;color:#657b83;">z </span><span style="background-color:#fdf6e3;color:#b58900;">≠ </span><span style="background-color:#fdf6e3;color:#6c71c4;">0</span> is the largest natural number <span style="background-color:#fdf6e3;color:#657b83;">n</span> such that
p^n divides z.</p>
<p><span style="background-color:#fdf6e3;color:#657b83;">padic_val_rat</span> defines the valuation of a rational <span style="background-color:#fdf6e3;color:#657b83;">q</span> to be the valuation of <span style="background-color:#fdf6e3;color:#657b83;">q.num</span> minus the
valuation of <span style="background-color:#fdf6e3;color:#657b83;">q.denom</span>.
If <span style="background-color:#fdf6e3;color:#657b83;">q </span><span style="background-color:#fdf6e3;color:#b58900;">= </span><span style="background-color:#fdf6e3;color:#6c71c4;">0</span> or <span style="background-color:#fdf6e3;color:#657b83;">p </span><span style="background-color:#fdf6e3;color:#b58900;">= </span><span style="background-color:#fdf6e3;color:#6c71c4;">1</span>, then <span style="background-color:#fdf6e3;color:#657b83;">padic_val_rat p q</span> defaults to 0.</p>
</div></div><div class="decl"><h4>padic_val_rat_def</h4><div class="decl_par"><p>A simplification of the definition of <span style="background-color:#fdf6e3;color:#657b83;">padic_val_rat p q</span> when <span style="background-color:#fdf6e3;color:#657b83;">q </span><span style="background-color:#fdf6e3;color:#b58900;">≠ </span><span style="background-color:#fdf6e3;color:#6c71c4;">0</span> and <span style="background-color:#fdf6e3;color:#657b83;">p</span> is prime.</p>
</div></div><div class="decl"><h4>padic_val_rat.neg</h4><div class="decl_par"><p><span style="background-color:#fdf6e3;color:#657b83;">padic_val_rat p q</span> is symmetric in <span style="background-color:#fdf6e3;color:#657b83;">q</span>.</p>
</div></div><div class="decl"><h4>padic_val_rat.one</h4><div class="decl_par"><p><span style="background-color:#fdf6e3;color:#657b83;">padic_val_rat p </span><span style="background-color:#fdf6e3;color:#6c71c4;">1</span> is 0 for any <span style="background-color:#fdf6e3;color:#657b83;">p</span>.</p>
</div></div><div class="decl"><h4>padic_val_rat.padic_val_rat_self</h4><div class="decl_par"><p>For <span style="background-color:#fdf6e3;color:#657b83;">p </span><span style="background-color:#fdf6e3;color:#b58900;">≠ </span><span style="background-color:#fdf6e3;color:#6c71c4;">0</span><span style="background-color:#fdf6e3;color:#657b83;">, p </span><span style="background-color:#fdf6e3;color:#b58900;">≠ </span><span style="background-color:#fdf6e3;color:#6c71c4;">1</span><span style="background-color:#fdf6e3;color:#657b83;">, </span>padic_val_rat p p` is 1.</p>
</div></div><div class="decl"><h4>padic_val_rat.padic_val_rat_of_int</h4><div class="decl_par"><p>The p-adic value of an integer <span style="background-color:#fdf6e3;color:#657b83;">z </span><span style="background-color:#fdf6e3;color:#b58900;">≠ </span><span style="background-color:#fdf6e3;color:#6c71c4;">0</span> is the multiplicity of <span style="background-color:#fdf6e3;color:#657b83;">p</span> in <span style="background-color:#fdf6e3;color:#657b83;">z</span>.</p>
</div></div><div class="decl"><h4>padic_val_rat.finite_int_prime_iff</h4><div class="decl_par"><p>The multiplicity of <span style="background-color:#fdf6e3;color:#657b83;">p : ℕ</span> in <span style="background-color:#fdf6e3;color:#657b83;">a : ℤ</span> is finite exactly when <span style="background-color:#fdf6e3;color:#657b83;">a </span><span style="background-color:#fdf6e3;color:#b58900;">≠ </span><span style="background-color:#fdf6e3;color:#6c71c4;">0</span>.</p>
</div></div><div class="decl"><h4>padic_val_rat.defn</h4><div class="decl_par"><p>A rewrite lemma for <span style="background-color:#fdf6e3;color:#657b83;">padic_val_rat p q</span> when <span style="background-color:#fdf6e3;color:#657b83;">q</span> is expressed in terms of <span style="background-color:#fdf6e3;color:#657b83;">rat.mk</span>.</p>
</div></div><div class="decl"><h4>padic_val_rat.mul</h4><div class="decl_par"><p>A rewrite lemma for <span style="background-color:#fdf6e3;color:#657b83;">padic_val_rat p (q </span><span style="background-color:#fdf6e3;color:#b58900;">*</span><span style="background-color:#fdf6e3;color:#657b83;"> r)</span> with conditions <span style="background-color:#fdf6e3;color:#657b83;">q </span><span style="background-color:#fdf6e3;color:#b58900;">≠ </span><span style="background-color:#fdf6e3;color:#6c71c4;">0</span>, <span style="background-color:#fdf6e3;color:#657b83;">r </span><span style="background-color:#fdf6e3;color:#b58900;">≠ </span><span style="background-color:#fdf6e3;color:#6c71c4;">0</span>.</p>
</div></div><div class="decl"><h4>padic_val_rat.pow</h4><div class="decl_par"><p>A rewrite lemma for <span style="background-color:#fdf6e3;color:#657b83;">padic_val_rat p (q^k) </span><span style="background-color:#fdf6e3;color:#859900;">with</span><span style="background-color:#fdf6e3;color:#657b83;"> condition </span>q ≠ 0`.</p>
</div></div><div class="decl"><h4>padic_val_rat.inv</h4><div class="decl_par"><p>A rewrite lemma for <span style="background-color:#fdf6e3;color:#657b83;">padic_val_rat p (q</span><span style="background-color:#fdf6e3;color:#b58900;">⁻¹</span><span style="background-color:#fdf6e3;color:#657b83;">)</span> with condition <span style="background-color:#fdf6e3;color:#657b83;">q </span><span style="background-color:#fdf6e3;color:#b58900;">≠ </span><span style="background-color:#fdf6e3;color:#6c71c4;">0</span>.</p>
</div></div><div class="decl"><h4>padic_val_rat.div</h4><div class="decl_par"><p>A rewrite lemma for <span style="background-color:#fdf6e3;color:#657b83;">padic_val_rat p (q </span><span style="background-color:#fdf6e3;color:#b58900;">/</span><span style="background-color:#fdf6e3;color:#657b83;"> r)</span> with conditions <span style="background-color:#fdf6e3;color:#657b83;">q </span><span style="background-color:#fdf6e3;color:#b58900;">≠ </span><span style="background-color:#fdf6e3;color:#6c71c4;">0</span>, <span style="background-color:#fdf6e3;color:#657b83;">r </span><span style="background-color:#fdf6e3;color:#b58900;">≠ </span><span style="background-color:#fdf6e3;color:#6c71c4;">0</span>.</p>
</div></div><div class="decl"><h4>padic_val_rat.padic_val_rat_le_padic_val_rat_iff</h4><div class="decl_par"><p>A condition for <span style="background-color:#fdf6e3;color:#657b83;">padic_val_rat p (n₁ </span><span style="background-color:#fdf6e3;color:#b58900;">/</span><span style="background-color:#fdf6e3;color:#657b83;"> d₁) </span><span style="background-color:#fdf6e3;color:#b58900;">≤</span><span style="background-color:#fdf6e3;color:#657b83;"> padic_val_rat p (n₂ </span><span style="background-color:#fdf6e3;color:#b58900;">/</span><span style="background-color:#fdf6e3;color:#657b83;"> d₂), </span><span style="background-color:#fdf6e3;color:#859900;">in</span><span style="background-color:#fdf6e3;color:#657b83;"> terms of divisibility </span><span style="background-color:#fdf6e3;color:#859900;">by </span>p^n`.</p>
</div></div><div class="decl"><h4>padic_val_rat.le_padic_val_rat_add_of_le</h4><div class="decl_par"><p>Sufficient conditions to show that the p-adic valuation of <span style="background-color:#fdf6e3;color:#657b83;">q</span> is less than or equal to the
p-adic vlauation of <span style="background-color:#fdf6e3;color:#657b83;">q </span><span style="background-color:#fdf6e3;color:#b58900;">+</span><span style="background-color:#fdf6e3;color:#657b83;"> r</span>.</p>
</div></div><div class="decl"><h4>padic_val_rat.min_le_padic_val_rat_add</h4><div class="decl_par"><p>The minimum of the valuations of <span style="background-color:#fdf6e3;color:#657b83;">q</span> and <span style="background-color:#fdf6e3;color:#657b83;">r</span> is less than or equal to the valuation of <span style="background-color:#fdf6e3;color:#657b83;">q </span><span style="background-color:#fdf6e3;color:#b58900;">+</span><span style="background-color:#fdf6e3;color:#657b83;"> r</span>.</p>
</div></div><div class="decl"><h4>padic_norm</h4><div class="decl_par"><p>If <span style="background-color:#fdf6e3;color:#657b83;">q </span><span style="background-color:#fdf6e3;color:#b58900;">≠ </span><span style="background-color:#fdf6e3;color:#6c71c4;">0</span>, the p-adic norm of a rational <span style="background-color:#fdf6e3;color:#657b83;">q</span> is <span style="background-color:#fdf6e3;color:#657b83;">p ^ (</span><span style="background-color:#fdf6e3;color:#b58900;">-</span><span style="background-color:#fdf6e3;color:#657b83;">(padic_val_rat p q))</span>.
If <span style="background-color:#fdf6e3;color:#657b83;">q </span><span style="background-color:#fdf6e3;color:#b58900;">= </span><span style="background-color:#fdf6e3;color:#6c71c4;">0</span>, the p-adic norm of <span style="background-color:#fdf6e3;color:#657b83;">q</span> is 0.</p>
</div></div><div class="decl"><h4>padic_norm.eq_fpow_of_nonzero</h4><div class="decl_par"><p>Unfolds the definition of the p-adic norm of <span style="background-color:#fdf6e3;color:#657b83;">q</span> when <span style="background-color:#fdf6e3;color:#657b83;">q </span><span style="background-color:#fdf6e3;color:#b58900;">≠ </span><span style="background-color:#fdf6e3;color:#6c71c4;">0</span>.</p>
</div></div><div class="decl"><h4>padic_norm.nonneg</h4><div class="decl_par"><p>The p-adic norm is nonnegative.</p>
</div></div><div class="decl"><h4>padic_norm.zero</h4><div class="decl_par"><p>The p-adic norm of 0 is 0.</p>
</div></div><div class="decl"><h4>padic_norm.one</h4><div class="decl_par"><p>The p-adic norm of 1 is 1.</p>
</div></div><div class="decl"><h4>padic_norm.image</h4><div class="decl_par"><p>The image of <span style="background-color:#fdf6e3;color:#657b83;">padic_norm p</span> is {0} ∪ {p^(-n) | n ∈ ℤ}.</p>
</div></div><div class="decl"><h4>padic_norm.nonzero</h4><div class="decl_par"><p>If <span style="background-color:#fdf6e3;color:#657b83;">q </span><span style="background-color:#fdf6e3;color:#b58900;">≠ </span><span style="background-color:#fdf6e3;color:#6c71c4;">0</span>, then <span style="background-color:#fdf6e3;color:#657b83;">padic_norm p q </span><span style="background-color:#fdf6e3;color:#b58900;">≠ </span><span style="background-color:#fdf6e3;color:#6c71c4;">0</span>.</p>
</div></div><div class="decl"><h4>padic_norm.neg</h4><div class="decl_par"><p><span style="background-color:#fdf6e3;color:#657b83;">padic_norm p</span> is symmetric.</p>
</div></div><div class="decl"><h4>padic_norm.zero_of_padic_norm_eq_zero</h4><div class="decl_par"><p>If the p-adic norm of <span style="background-color:#fdf6e3;color:#657b83;">q</span> is 0, then <span style="background-color:#fdf6e3;color:#657b83;">q</span> is 0.</p>
</div></div><div class="decl"><h4>padic_norm.mul</h4><div class="decl_par"><p>The p-adic norm is multiplicative.</p>
</div></div><div class="decl"><h4>padic_norm.div</h4><div class="decl_par"><p>The p-adic norm respects division.</p>
</div></div><div class="decl"><h4>padic_norm.of_int</h4><div class="decl_par"><p>The p-adic norm of an integer is at most 1.</p>
</div></div><div class="decl"><h4>padic_norm.nonarchimedean</h4><div class="decl_par"><p>The p-adic norm is nonarchimedean: the norm of <span style="background-color:#fdf6e3;color:#657b83;">p </span><span style="background-color:#fdf6e3;color:#b58900;">+</span><span style="background-color:#fdf6e3;color:#657b83;"> q</span> is at most the max of the norm of <span style="background-color:#fdf6e3;color:#657b83;">p</span> and
the norm of <span style="background-color:#fdf6e3;color:#657b83;">q</span>.</p>
</div></div><div class="decl"><h4>padic_norm.triangle_ineq</h4><div class="decl_par"><p>The p-adic norm respects the triangle inequality: the norm of <span style="background-color:#fdf6e3;color:#657b83;">p </span><span style="background-color:#fdf6e3;color:#b58900;">+</span><span style="background-color:#fdf6e3;color:#657b83;"> q</span> is at most the norm of <span style="background-color:#fdf6e3;color:#657b83;">p</span>
plus the norm of <span style="background-color:#fdf6e3;color:#657b83;">q</span>.</p>
</div></div><div class="decl"><h4>padic_norm.sub</h4><div class="decl_par"><p>The p-adic norm of a difference is at most the max of each component. Restates the archimedean
property of the p-adic norm.</p>
</div></div><div class="decl"><h4>padic_norm.add_eq_max_of_ne</h4><div class="decl_par"><p>If the p-adic norms of <span style="background-color:#fdf6e3;color:#657b83;">q</span> and <span style="background-color:#fdf6e3;color:#657b83;">r</span> are different, then the norm of <span style="background-color:#fdf6e3;color:#657b83;">q </span><span style="background-color:#fdf6e3;color:#b58900;">+</span><span style="background-color:#fdf6e3;color:#657b83;"> r</span> is equal to the max of
the norms of <span style="background-color:#fdf6e3;color:#657b83;">q</span> and <span style="background-color:#fdf6e3;color:#657b83;">r</span>.</p>
</div></div><div class="decl"><h4>padic_norm.is_absolute_value</h4><div class="decl_par"><p>The p-adic norm is an absolute value: positive-definite and multiplicative, satisfying the triangle
inequality.</p>
</div></div><div class="decl"><h4>padic_norm.le_of_dvd</h4><div class="decl_par"><p>If <span style="background-color:#fdf6e3;color:#657b83;">p^n</span> divides an integer <span style="background-color:#fdf6e3;color:#657b83;">z</span>, then the p-adic norm of <span style="background-color:#fdf6e3;color:#657b83;">z</span> is at most <span style="background-color:#fdf6e3;color:#657b83;">p^(</span><span style="background-color:#fdf6e3;color:#b58900;">-</span><span style="background-color:#fdf6e3;color:#657b83;">n)</span>.</p>
</div></div></html>